---
title: "Практическая работа №2. Основы обработки данных с помощью R и Dplyr"
author: "yaroslavprishedko@yandex.ru"
format: 
  md:
    output-file: README.md
---

## Цель работы

1.  Развить практические навыки использования языка программирования R для обработки данных
2.  Закрепить знания базовых типов данных языка R
3.  Развить практические навыки использования функций обработки данных пакета `dplyr` – функции `select()`, `filter()`, `mutate()`, `arrange()`, `group_by()`

## Исходные данные

1.  Программное обеспечение MacOS Version 15.7.1 (24G231)
2.  RStudio Desktop
3.  Интерпретатор языка R 4.5.2

## Задание

Проанализировать встроенный в пакет dplyr набор данных starwars с помощью языка R и ответить на вопросы

## Ход работы

1.  Проанализировать встроенный в пакет dplyr набор данных starwars с помощью языка R и ответить на вопросы:
    -   Сколько строк в датафрейме?
    -   Сколько столбцов в датафрейме?
    -   Как просмотреть примерный вид датафрейма?
    -   Сколько уникальных рас персонажей (species) представлено в данных?
    -   Найти самого высокого персонажа.
    -   Найти всех персонажей ниже 170
    -   Подсчитать ИМТ (индекс массы тела) для всех персонажей.
    -   Найти 10 самых "вытянутых" персонажей. "Вытянутость" оценить по отношению массы (mass) к росту (height) персонажей
    -   Найти средний возраст персонажей каждой расы вселенной Звездных войн
    -   Найти самый распространенный цвет глаз персонажей вселенной Звездных войн.
    -   Подсчитать среднюю длину имени в каждой расе вселенной Звездных войн.
2.  Оценить результаты и сделать вывод

## Шаги:

### Шаг 1

#### 1. Загрузка и предварительный анализ данных

```{r}
library(dplyr)
data(starwars)
```

#### Вопрос 1: Сколько строк в датафрейме?

```{r}
nrow(starwars)
```

#### Вопрос 2: Сколько столбцов в датафрейме?

```{r}
ncol(starwars)
```

#### Вопрос 3: Как просмотреть примерный вид датафрейма?

```{r}
glimpse(starwars)
```

#### Вопрос 4: Сколько уникальных рас персонажей (species) представлено в данных?

```{r}
starwars %>% distinct(species) %>% nrow()
```

#### Вопрос 5: Найти самого высокого персонажа

```{r}
starwars %>%
    filter(height == max(height,na.rm = TRUE)) %>%
    pull(name)
```

#### Вопрос 6: Найти всех персонажей ниже 170

```{r}
starwars %>%
    filter(height < 170) %>%
    select(name, height)
```

#### Вопрос 7: Подсчитать ИМТ (индекс массы тела) для всех персонажей.

```{r}
starwars %>%
    mutate(height_m = height / 100,bmi = mass / (height_m)^2) %>%
    select(name, mass, height, bmi)
```

#### Вопрос 8: Найти 10 самых "вытянутых" персонажей. "Вытянутость" оценить по отношению массы (mass) к росту (height) персонажей.

```{r}
starwars %>% 
    mutate(stretch_ratio = mass / height) %>%
    filter(!is.na(stretch_ratio)) %>%
    arrange(desc(stretch_ratio)) %>%
    head(10) %>%
    select(name, mass, height, stretch_ratio)
```

#### Вопрос 9: Найти средний возраст персонажей каждой расы вселенной Звездных войн.

```{r}
starwars %>% 
    filter(!is.na(species), !is.na(birth_year)) %>%
    group_by(species) %>%
    summarise(
        count = n(),
        avg_birth_year = mean(birth_year, na.rm = TRUE)
    ) %>% 
    arrange(desc(avg_birth_year))
```

#### Вопрос 10: Найти самый распространенный цвет глаз персонажей вселенной Звездных войн.

```{r}
starwars %>%
    group_by(eye_color) %>%
    summarise(n = n(), .groups = "drop") %>%
    arrange(desc(n)) %>%
    slice(1)
```

#### Вопрос 11: Подсчитать среднюю длину имени в каждой расе вселенной Звездных войн.

```{r}
starwars %>%
    filter(!is.na(species), !is.na(name)) %>%
    group_by(species) %>%
    summarise(
        count = n(),
        avg_length = mean(nchar(name)),
        .groups = "drop"
    )
```

### Шаг 2

#### Оценка результатов

В ходе выполнения работы были успешно применены функции пакета dplyr для анализа набора данных starwars (`select`, `filter`, `mutate`, `arrange`, `group_by`, `summarise`).

#### Вывод

В результате выполнения практической работы удалось получить навыки использования языка `R` и пакета `dplyr` для обработки и анализа данных. Были успешно применены ключевые функции dplyr для решения конкретных аналитических задач на реальном наборе данных.